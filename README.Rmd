---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# mcATAC

## Installation

You can install the development version of mcATAC like so:

``` r
remotes::install_github("tanaylab/mcATAC")
```

## Example

```{r download-data, eval = FALSE}
if (!dir.exists("pbmc_data")){
  download_pbmc_example_data()
}
```

### Import ATAC dataset

```{r import}
atac_sc <- import_from_10x("pbmc_data", genome = "hg38", id = "pbmc", description = "PBMC from a healthy donor - granulocytes removed through cell sorting (10k)")
atac_sc
```

### Filter peaks by coverage and/or length
```{r filter-peaks}
atac_sc <- filter_features(scatac = atac_sc, minimal_max_umi = 3, min_peak_length = 200, max_peak_length = 1000)
```


### Project RNA metacells 

```{r cell_to_metacell}
data(cell_to_metacell_pbmc_example)
head(cell_to_metacell_pbmc_example)
```

```{r project}
atac_mc <- project_atac_on_mc(atac_sc, cell_to_metacell_pbmc_example)
atac_mc
```

See more at the [vignette](https://tanaylab.github.io/mcATAC/articles/mcATAC.html)
